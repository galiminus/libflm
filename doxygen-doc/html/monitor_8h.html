<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>libflm-0.3: monitor.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="libflm.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.3 -->
<script type="text/javascript">
function hasClass(ele,cls) {
  return ele.className.match(new RegExp('(\\s|^)'+cls+'(\\s|$)'));
}

function addClass(ele,cls) {
  if (!this.hasClass(ele,cls)) ele.className += " "+cls;
}

function removeClass(ele,cls) {
  if (hasClass(ele,cls)) {
    var reg = new RegExp('(\\s|^)'+cls+'(\\s|$)');
    ele.className=ele.className.replace(reg,' ');
  }
}

function toggleVisibility(linkObj) {
 var base = linkObj.getAttribute('id');
 var summary = document.getElementById(base + '-summary');
 var content = document.getElementById(base + '-content');
 var trigger = document.getElementById(base + '-trigger');
 if ( hasClass(linkObj,'closed') ) {
   summary.style.display = 'none';
   content.style.display = 'block';
   trigger.src = 'open.png';
   removeClass(linkObj,'closed');
   addClass(linkObj,'opened');
 } else if ( hasClass(linkObj,'opened') ) {
   summary.style.display = 'block';
   content.style.display = 'none';
   trigger.src = 'closed.png';
   removeClass(linkObj,'opened');
   addClass(linkObj,'closed');
 }
 return false;
}
</script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">libflm-0.3&#160;<span id="projectnumber">0.3</span></div>
   <div id="projectbrief">A simple event-driven IO library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<h1>monitor.h File Reference</h1>  </div>
</div>
<div class="contents">

<p>The main event loop object.  
<a href="#_details">More...</a></p>

<p><a href="monitor_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">flm_Monitor *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="monitor_8h.html#a9ac7adccec16433fe0acbc6a9570aec9">flm_MonitorNew</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a new flm_Monitor object.  <a href="#a9ac7adccec16433fe0acbc6a9570aec9"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="monitor_8h.html#ae0cdcfb013a0acca6b1e740d5d4086b7">flm_MonitorWait</a> (flm_Monitor *monitor)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Wait for events.  <a href="#ae0cdcfb013a0acca6b1e740d5d4086b7"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">flm_Monitor *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="monitor_8h.html#a57b7e8cb44d00e8c53e0c6db9fcb7187">flm_MonitorRetain</a> (flm_Monitor *monitor)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Increment the reference counter.  <a href="#a57b7e8cb44d00e8c53e0c6db9fcb7187"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="monitor_8h.html#a8a00c66f9e90881a0ef4623ec0dbd9ad">flm_MonitorRelease</a> (flm_Monitor *monitor)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Decrement the reference counter.  <a href="#a8a00c66f9e90881a0ef4623ec0dbd9ad"></a><br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>The main event loop object. </p>
<p><code>A</code> monitor handle Input/Ouput, threads and timer. It is basically an event loop waiting from kernel notifications, and using the best supported I/O notification framework available on the system. Currently, only epoll(7) and select(2) are supported. </p>

<p>Definition in file <a class="el" href="monitor_8h_source.html">monitor.h</a>.</p>
</div><hr/><h2>Function Documentation</h2>
<a class="anchor" id="a9ac7adccec16433fe0acbc6a9570aec9"></a><!-- doxytag: member="monitor.h::flm_MonitorNew" ref="a9ac7adccec16433fe0acbc6a9570aec9" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">flm_Monitor* flm_MonitorNew </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Create a new flm_Monitor object. </p>
<dl class="remark"><dt><b>Remarks:</b></dt><dd>Monitors are not thread-safe, using the same monitor in multiple threads will probably lead to an application crash. But it is possible to create as many monitor as needed, one for each thread.</dd></dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>A pointer to a new flm_Monitor object. </dd></dl>
<dl><dt><b>Examples: </b></dt><dd><a class="el" href="Monitor_01unit_01tests-example.html#a0">Monitor unit tests</a>, and <a class="el" href="Timer_01unit_01tests-example.html#a0">Timer unit tests</a>.</dd>
</dl>
</div>
</div>
<a class="anchor" id="ae0cdcfb013a0acca6b1e740d5d4086b7"></a><!-- doxytag: member="monitor.h::flm_MonitorWait" ref="ae0cdcfb013a0acca6b1e740d5d4086b7" args="(flm_Monitor *monitor)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int flm_MonitorWait </td>
          <td>(</td>
          <td class="paramtype">flm_Monitor *&#160;</td>
          <td class="paramname"><em>monitor</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Wait for events. </p>
<dl class="remark"><dt><b>Remarks:</b></dt><dd>This function returns in case of error, when there is nothing to monitor or when all the monitored objects are closed and all timers elapsed.</dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">monitor</td><td>A pointer to a flm_Monitor object.</td></tr>
  </table>
  </dd>
</dl>
<dl class="user"><dt><b>Example of IO monitoring</b></dt><dd><div class="fragment"><pre class="fragment"> flm_Monitor *        monitor;
 flm_IO *             io;
 <span class="keywordtype">int</span>                  fd;

 monitor = <a class="code" href="monitor_8h.html#a9ac7adccec16433fe0acbc6a9570aec9" title="Create a new flm_Monitor object.">flm_MonitorNew</a> ();
 
 fd = open (<span class="stringliteral">&quot;/dev/zero&quot;</span>, O_RDONLY);
 io = <a class="code" href="io_8h.html#a7b692f86b3b28dab624d25e119578148">flm_IONew</a> (monitor, fd, NULL);
 flm_IORead (io, my_read_handler);
 <a class="code" href="io_8h.html#ad046ca12dad9998ea32fb977b93a26b0">flm_IORelease</a> (io);

 <a class="code" href="monitor_8h.html#ae0cdcfb013a0acca6b1e740d5d4086b7" title="Wait for events.">flm_MonitorWait</a> (monitor);
</pre></div> </dd></dl>
<dl><dt><b>Examples: </b></dt><dd><a class="el" href="Monitor_01unit_01tests-example.html#a5">Monitor unit tests</a>, and <a class="el" href="Timer_01unit_01tests-example.html#a5">Timer unit tests</a>.</dd>
</dl>
</div>
</div>
<a class="anchor" id="a57b7e8cb44d00e8c53e0c6db9fcb7187"></a><!-- doxytag: member="monitor.h::flm_MonitorRetain" ref="a57b7e8cb44d00e8c53e0c6db9fcb7187" args="(flm_Monitor *monitor)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">flm_Monitor* flm_MonitorRetain </td>
          <td>(</td>
          <td class="paramtype">flm_Monitor *&#160;</td>
          <td class="paramname"><em>monitor</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Increment the reference counter. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">monitor</td><td>A pointer to a flm_Monitor object. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The same pointer, this function cannot fail. </dd></dl>

</div>
</div>
<a class="anchor" id="a8a00c66f9e90881a0ef4623ec0dbd9ad"></a><!-- doxytag: member="monitor.h::flm_MonitorRelease" ref="a8a00c66f9e90881a0ef4623ec0dbd9ad" args="(flm_Monitor *monitor)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void flm_MonitorRelease </td>
          <td>(</td>
          <td class="paramtype">flm_Monitor *&#160;</td>
          <td class="paramname"><em>monitor</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Decrement the reference counter. </p>
<p>When the counter reaches zero all the internals references to monitored IO objects, timers and threads will be released and those objects will be freed if there is no more references to them.</p>
<dl class="remark"><dt><b>Remarks:</b></dt><dd>The underlying file descriptor of the IO objects will not be automatically closed.</dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">monitor</td><td>A pointer to a flm_Monitor object. </td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Examples: </b></dt><dd><a class="el" href="Monitor_01unit_01tests-example.html#a4">Monitor unit tests</a>, and <a class="el" href="Timer_01unit_01tests-example.html#a3">Timer unit tests</a>.</dd>
</dl>
</div>
</div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Thu Mar 17 2011 for libflm-0.3 by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.3 </small></address>
</body>
</html>

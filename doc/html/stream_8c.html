<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>libflm: src/stream.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.3 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">libflm&#160;<span id="projectnumber">0.2.0</span></div>
   <div id="projectbrief">A simple event-driven IO library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<h1>src/stream.c File Reference</h1>  </div>
</div>
<div class="contents">
<div class="textblock"><code>#include &lt;sys/uio.h&gt;</code><br/>
<code>#include &lt;sys/types.h&gt;</code><br/>
<code>#include &lt;sys/socket.h&gt;</code><br/>
<code>#include &lt;netinet/in.h&gt;</code><br/>
<code>#include &lt;arpa/inet.h&gt;</code><br/>
<code>#include &lt;sys/queue.h&gt;</code><br/>
<code>#include &lt;sys/sendfile.h&gt;</code><br/>
<code>#include &lt;errno.h&gt;</code><br/>
<code>#include &lt;fcntl.h&gt;</code><br/>
<code>#include &lt;netdb.h&gt;</code><br/>
<code>#include &lt;stdio.h&gt;</code><br/>
<code>#include &lt;string.h&gt;</code><br/>
<code>#include &lt;unistd.h&gt;</code><br/>
<code>#include &lt;openssl/ssl.h&gt;</code><br/>
<code>#include &quot;flm/core/public/container.h&quot;</code><br/>
<code>#include &quot;flm/core/private/alloc.h&quot;</code><br/>
<code>#include &quot;flm/core/private/buffer.h&quot;</code><br/>
<code>#include &quot;flm/core/private/error.h&quot;</code><br/>
<code>#include &quot;flm/core/private/file.h&quot;</code><br/>
<code>#include &quot;flm/core/private/io.h&quot;</code><br/>
<code>#include &quot;flm/core/private/monitor.h&quot;</code><br/>
<code>#include &quot;flm/core/private/obj.h&quot;</code><br/>
<code>#include &quot;flm/core/private/stream.h&quot;</code><br/>
</div>
<p><a href="stream_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="stream_8h.html#a65e0530bc901a350586f5e057d6195d8">flm_Stream</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream_8c.html#ac89ebf8bef6afa634e7097060d4988d9">flm_StreamNew</a> (<a class="el" href="monitor_8h.html#a4dbc134cf7b201482c4cd40297937c83">flm_Monitor</a> *monitor, int fd, void *state)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream_8c.html#af82bbe9b6534bd640bad977106fba5d0">flm_StreamPrintf</a> (<a class="el" href="stream_8h.html#a65e0530bc901a350586f5e057d6195d8">flm_Stream</a> *stream, const char *format,...)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream_8c.html#adad497fd1d6cad72b6da00b297a45c00">flm_StreamPushBuffer</a> (<a class="el" href="stream_8h.html#a65e0530bc901a350586f5e057d6195d8">flm_Stream</a> *stream, <a class="el" href="buffer_8h.html#ae3f88afa1850fc7dee9e958bd023d220">flm_Buffer</a> *buffer, off_t off, size_t count)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream_8c.html#a0c2f4e67b4018f9772cc02904a562803">flm_StreamPushFile</a> (<a class="el" href="stream_8h.html#a65e0530bc901a350586f5e057d6195d8">flm_Stream</a> *stream, <a class="el" href="file_8h.html#a6d8926d421432d97489a92bda2cd53bf">flm_File</a> *file, off_t off, size_t count)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream_8c.html#a14ab6f72503af42413a2a65fb8128344">flm_StreamShutdown</a> (<a class="el" href="stream_8h.html#a65e0530bc901a350586f5e057d6195d8">flm_Stream</a> *stream)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream_8c.html#a1a5e35800f405a10bc937b0d96bcd25a">flm_StreamClose</a> (<a class="el" href="stream_8h.html#a65e0530bc901a350586f5e057d6195d8">flm_Stream</a> *stream)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream_8c.html#a87cf04647e6d86a1037876f2093f949d">flm_StreamOnRead</a> (<a class="el" href="stream_8h.html#a65e0530bc901a350586f5e057d6195d8">flm_Stream</a> *stream, <a class="el" href="stream_8h.html#a0ec80f75578491f6de5a5bbb7e3e659b">flm_StreamReadHandler</a> handler)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream_8c.html#a6b92f4a44789145b5922c13c14f30af3">flm_StreamOnWrite</a> (<a class="el" href="stream_8h.html#a65e0530bc901a350586f5e057d6195d8">flm_Stream</a> *stream, <a class="el" href="stream_8h.html#aaf1b1cc6600a251e810f1d01a0743030">flm_StreamWriteHandler</a> handler)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream_8c.html#a721b84a665aa58dcfb99e4ba50d354d9">flm_StreamOnClose</a> (<a class="el" href="stream_8h.html#a65e0530bc901a350586f5e057d6195d8">flm_Stream</a> *stream, <a class="el" href="stream_8h.html#a0519764167d1d77205bb965935a1913a">flm_StreamCloseHandler</a> handler)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream_8c.html#a378ebbec28871878b0e521f3a6c0e715">flm_StreamOnError</a> (<a class="el" href="stream_8h.html#a65e0530bc901a350586f5e057d6195d8">flm_Stream</a> *stream, <a class="el" href="stream_8h.html#a1ab38a34ece4f7b1dff7527bab15751b">flm_StreamErrorHandler</a> handler)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream_8c.html#adad86858ba5e1266089929dc369635f1">flm_StreamStartTLSServer</a> (<a class="el" href="stream_8h.html#a65e0530bc901a350586f5e057d6195d8">flm_Stream</a> *stream, SSL_CTX *context)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream_8c.html#a4623c56ab66662b0dfd9ca8bc7d81e57">flm_StreamStartTLSClient</a> (<a class="el" href="stream_8h.html#a65e0530bc901a350586f5e057d6195d8">flm_Stream</a> *stream, SSL_CTX *context)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="stream_8h.html#a65e0530bc901a350586f5e057d6195d8">flm_Stream</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream_8c.html#ab6fabd6657be4765086bb825e9bcd525">flm_StreamRetain</a> (<a class="el" href="stream_8h.html#a65e0530bc901a350586f5e057d6195d8">flm_Stream</a> *stream)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream_8c.html#ada4474f10a2c8e7d97b27c983d56ef6c">flm_StreamRelease</a> (<a class="el" href="stream_8h.html#a65e0530bc901a350586f5e057d6195d8">flm_Stream</a> *stream)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream_8c.html#a9af7e295293b36ff362a0faba9e7938f">flm__StreamInit</a> (<a class="el" href="stream_8h.html#a65e0530bc901a350586f5e057d6195d8">flm_Stream</a> *stream, <a class="el" href="monitor_8h.html#a4dbc134cf7b201482c4cd40297937c83">flm_Monitor</a> *monitor, int fd, void *state)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream_8c.html#ae17c28596897dc6eba0b22881196cebb">flm__StreamInitTLS</a> (<a class="el" href="stream_8h.html#a65e0530bc901a350586f5e057d6195d8">flm_Stream</a> *stream, SSL_CTX *context)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream_8c.html#a19b905a588314f7d097f1a4c29defd38">flm__StreamShutdownTLS</a> (<a class="el" href="stream_8h.html#a65e0530bc901a350586f5e057d6195d8">flm_Stream</a> *stream)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream_8c.html#a3eb76a521bb8560f0b80a6633f79612b">flm__StreamPerfDestruct</a> (<a class="el" href="stream_8h.html#a65e0530bc901a350586f5e057d6195d8">flm_Stream</a> *stream)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream_8c.html#a5beabfbfce7d8b268b1705e4bf0fcc35">flm__StreamPerfRead</a> (<a class="el" href="stream_8h.html#a65e0530bc901a350586f5e057d6195d8">flm_Stream</a> *stream, <a class="el" href="monitor_8h.html#a4dbc134cf7b201482c4cd40297937c83">flm_Monitor</a> *monitor, uint8_t count)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream_8c.html#af98cfd968a8e3576aaa8b55ec3497acf">flm__StreamPerfWrite</a> (<a class="el" href="stream_8h.html#a65e0530bc901a350586f5e057d6195d8">flm_Stream</a> *stream, <a class="el" href="monitor_8h.html#a4dbc134cf7b201482c4cd40297937c83">flm_Monitor</a> *monitor, uint8_t count)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">ssize_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream_8c.html#abcc390327ac215570404c507b30bdc1a">flm__StreamWrite</a> (<a class="el" href="stream_8h.html#a65e0530bc901a350586f5e057d6195d8">flm_Stream</a> *stream)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">ssize_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream_8c.html#a45d2060862f33c3fbddb67c219528e46">flm__StreamSysWritev</a> (<a class="el" href="stream_8h.html#a65e0530bc901a350586f5e057d6195d8">flm_Stream</a> *stream)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">ssize_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream_8c.html#ada1019fb43bc6d7523a5aec6e5957421">flm__StreamSysSendFile</a> (<a class="el" href="stream_8h.html#a65e0530bc901a350586f5e057d6195d8">flm_Stream</a> *stream)</td></tr>
<tr><td colspan="2"><h2><a name="var-members"></a>
Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream_8c.html#a50d91b812f208363668840c0913b6179">flm__StreamErrors</a> []</td></tr>
</table>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a9af7e295293b36ff362a0faba9e7938f"></a><!-- doxytag: member="stream.c::flm__StreamInit" ref="a9af7e295293b36ff362a0faba9e7938f" args="(flm_Stream *stream, flm_Monitor *monitor, int fd, void *state)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int flm__StreamInit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stream_8h.html#a65e0530bc901a350586f5e057d6195d8">flm_Stream</a> *&#160;</td>
          <td class="paramname"><em>stream</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="monitor_8h.html#a4dbc134cf7b201482c4cd40297937c83">flm_Monitor</a> *&#160;</td>
          <td class="paramname"><em>monitor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>state</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="stream_8c_source.html#l00311">311</a> of file <a class="el" href="stream_8c_source.html">stream.c</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">if</span> (<a class="code" href="io_8c.html#a5de5a56b224631e2cb49ad5f7b820778">flm__IOInit</a> ((<a class="code" href="io_8h.html#acd3fd8ef9f4a34e935082468bbf981da">flm_IO</a> *) stream, monitor, fd, state) == -1) {
        <span class="keywordflow">return</span> (-1);
    }
    ((<a class="code" href="obj_8h.html#a06d6af323c74441b131bdec66c72f531">flm_Obj</a> *)(stream))-&gt;type = FLM__TYPE_STREAM;

    ((<a class="code" href="obj_8h.html#a06d6af323c74441b131bdec66c72f531">flm_Obj</a> *)(stream))-&gt;perf.destruct =                      \
        (flm__ObjPerfDestruct_f) <a class="code" href="stream_8c.html#a3eb76a521bb8560f0b80a6633f79612b">flm__StreamPerfDestruct</a>;

    ((<a class="code" href="io_8h.html#acd3fd8ef9f4a34e935082468bbf981da">flm_IO</a> *)(stream))-&gt;perf.read     =                       \
        (flm__IOSysRead_f) <a class="code" href="stream_8c.html#a5beabfbfce7d8b268b1705e4bf0fcc35">flm__StreamPerfRead</a>;

    ((<a class="code" href="io_8h.html#acd3fd8ef9f4a34e935082468bbf981da">flm_IO</a> *)(stream))-&gt;perf.write    =                       \
        (flm__IOSysWrite_f) <a class="code" href="stream_8c.html#af98cfd968a8e3576aaa8b55ec3497acf">flm__StreamPerfWrite</a>;

    TAILQ_INIT (&amp;stream-&gt;inputs);
    
    <a class="code" href="stream_8h.html#a87cf04647e6d86a1037876f2093f949d">flm_StreamOnRead</a> (stream, NULL);
    <a class="code" href="stream_8h.html#a6b92f4a44789145b5922c13c14f30af3">flm_StreamOnWrite</a> (stream, NULL);
    
    stream-&gt;tls.obj = NULL;
    
    <span class="keywordflow">return</span> (0);
}
</pre></div>
</div>
</div>
<a class="anchor" id="ae17c28596897dc6eba0b22881196cebb"></a><!-- doxytag: member="stream.c::flm__StreamInitTLS" ref="ae17c28596897dc6eba0b22881196cebb" args="(flm_Stream *stream, SSL_CTX *context)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int flm__StreamInitTLS </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stream_8h.html#a65e0530bc901a350586f5e057d6195d8">flm_Stream</a> *&#160;</td>
          <td class="paramname"><em>stream</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SSL_CTX *&#160;</td>
          <td class="paramname"><em>context</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="stream_8c_source.html#l00341">341</a> of file <a class="el" href="stream_8c_source.html">stream.c</a>.</p>
<div class="fragment"><pre class="fragment">{
    stream-&gt;tls.obj = SSL_new (context);
    <span class="keywordflow">if</span> (stream-&gt;tls.obj == NULL) {
        <span class="keywordflow">goto</span> error;
    }
    <span class="keywordflow">if</span> (!SSL_set_fd (stream-&gt;tls.obj, ((<a class="code" href="io_8h.html#acd3fd8ef9f4a34e935082468bbf981da">flm_IO</a> *)(stream))-&gt;sys.fd)) {
        <span class="keywordflow">goto</span> free_obj;
    }
    <span class="keywordflow">return</span> (0);

  free_obj:
    SSL_free (stream-&gt;tls.obj);
    stream-&gt;tls.obj = NULL;
  error:
    <span class="keywordflow">return</span> (-1);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a3eb76a521bb8560f0b80a6633f79612b"></a><!-- doxytag: member="stream.c::flm__StreamPerfDestruct" ref="a3eb76a521bb8560f0b80a6633f79612b" args="(flm_Stream *stream)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void flm__StreamPerfDestruct </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stream_8h.html#a65e0530bc901a350586f5e057d6195d8">flm_Stream</a> *&#160;</td>
          <td class="paramname"><em>stream</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="stream_8c_source.html#l00371">371</a> of file <a class="el" href="stream_8c_source.html">stream.c</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keyword">struct </span>flm__StreamInput * input;
    <span class="keyword">struct </span>flm__StreamInput temp;

    <span class="comment">/* remove remaining stuff to write */</span>
    TAILQ_FOREACH (input, &amp;stream-&gt;inputs, entries) {
        temp.entries = input-&gt;entries;
        <a class="code" href="obj_8c.html#a945a39c1ea76e1055163ba72e3a2a4d1">flm__Release</a> (input-&gt;class.obj);
        TAILQ_REMOVE (&amp;stream-&gt;inputs, input, entries);
        <a class="code" href="alloc_8c.html#a1f23294fcb8f31fc82577872ac7bab12">flm__Free</a> (input);
        input = &amp;temp;
    }
    <a class="code" href="stream_8c.html#a19b905a588314f7d097f1a4c29defd38">flm__StreamShutdownTLS</a> (stream);
    return ;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a5beabfbfce7d8b268b1705e4bf0fcc35"></a><!-- doxytag: member="stream.c::flm__StreamPerfRead" ref="a5beabfbfce7d8b268b1705e4bf0fcc35" args="(flm_Stream *stream, flm_Monitor *monitor, uint8_t count)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void flm__StreamPerfRead </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stream_8h.html#a65e0530bc901a350586f5e057d6195d8">flm_Stream</a> *&#160;</td>
          <td class="paramname"><em>stream</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="monitor_8h.html#a4dbc134cf7b201482c4cd40297937c83">flm_Monitor</a> *&#160;</td>
          <td class="paramname"><em>monitor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>count</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><p>the kernel buffer was empty</p>
<p>interrupted by a signal, just retry</p>
<p>Call the error handler</p>
<p>Call the error handler</p>
<p>Call the read handler with the new buffer</p>
</p>

<p>Definition at line <a class="el" href="stream_8c_source.html#l00389">389</a> of file <a class="el" href="stream_8c_source.html">stream.c</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keyword">struct </span>iovec iovec[count];
    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iov_count;
    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> drain_count;

    ssize_t nb_read;
    <span class="keywordtype">size_t</span> drain;

    <a class="code" href="buffer_8h.html#ae3f88afa1850fc7dee9e958bd023d220">flm_Buffer</a> * buffer;
    <span class="keywordtype">size_t</span> iov_read;

    (void) monitor;

    <span class="keywordflow">for</span> (iov_count = 0; iov_count &lt; count; iov_count++) {

        iovec[iov_count].iov_base = <a class="code" href="alloc_8c.html#aa9979f334876af9bcbe4c57c68a94cbb">flm__Alloc</a>(FLM_STREAM__RBUFFER_SIZE);

        <span class="keywordflow">if</span> (iovec[iov_count].iov_base == NULL) {
            <span class="comment">/* no more memory */</span>
            count = iov_count;
            break ;
        }
        iovec[iov_count].iov_len = FLM_STREAM__RBUFFER_SIZE;
    }
    <span class="keywordflow">if</span> (iov_count == 0) {
        return ;
    }

    nb_read = readv (((<a class="code" href="io_8h.html#acd3fd8ef9f4a34e935082468bbf981da">flm_IO</a> *)(stream))-&gt;sys.fd, iovec, iov_count);

    drain_count = 0;
    <span class="keywordflow">if</span> (nb_read == 0) {
        <span class="comment">/* close */</span>
        ((<a class="code" href="io_8h.html#acd3fd8ef9f4a34e935082468bbf981da">flm_IO</a> *)(stream))-&gt;rd.can = 0;
        <a class="code" href="io_8h.html#a5ee72d10acb72a90ffd6f1ae76890179" title="Close the flm_io object as soon as possible.">flm_IOShutdown</a> ((<a class="code" href="io_8h.html#acd3fd8ef9f4a34e935082468bbf981da">flm_IO</a> *) stream);
        <span class="keywordflow">goto</span> out;
    }
    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nb_read &lt; 0) {
        <span class="keywordflow">if</span> (errno == EAGAIN || errno == EWOULDBLOCK) {
            ((<a class="code" href="io_8h.html#acd3fd8ef9f4a34e935082468bbf981da">flm_IO</a> *)(stream))-&gt;rd.can = 0;
        }
        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (errno == EINTR) {
            ((<a class="code" href="io_8h.html#acd3fd8ef9f4a34e935082468bbf981da">flm_IO</a> *)(stream))-&gt;rd.can = 1;
        }
        <span class="keywordflow">else</span> {
            <span class="comment">/* fatal error */</span>
            flm__Error = <a class="code" href="error_8h.html#a9d9ce0322d33a2cf7912aec85755e04ea5fd1acb896d913dddb2ebce92d95153d">FLM_ERR_ERRNO</a>;
            <a class="code" href="io_8h.html#a1dca3f3c2913ea4525bd071c07cf6496" title="Close the flm_io object immediatly.">flm_IOClose</a> ((<a class="code" href="io_8h.html#acd3fd8ef9f4a34e935082468bbf981da">flm_IO</a> *) stream);
            <span class="keywordflow">if</span> (((<a class="code" href="io_8h.html#acd3fd8ef9f4a34e935082468bbf981da">flm_IO</a> *)(stream))-&gt;er.handler) {
                ((<a class="code" href="io_8h.html#acd3fd8ef9f4a34e935082468bbf981da">flm_IO</a> *)(stream))-&gt;er.handler ((<a class="code" href="io_8h.html#acd3fd8ef9f4a34e935082468bbf981da">flm_IO</a> *) stream,
                                                  ((<a class="code" href="io_8h.html#acd3fd8ef9f4a34e935082468bbf981da">flm_IO</a> *)(stream))-&gt;state,
                                                  <a class="code" href="error_8h.html#ad1766173eeafcea6be9be3c16c30fb95" title="Return last error code.">flm_Error</a>());
            }
        }
        <span class="keywordflow">goto</span> out;
    }
    <span class="comment">/* read event */</span>
    ((<a class="code" href="io_8h.html#acd3fd8ef9f4a34e935082468bbf981da">flm_IO</a> *)(stream))-&gt;rd.can = 1;
    for (drain = nb_read; drain; drain_count++) {

        iov_read = drain &lt; iovec[drain_count].iov_len ?         \
            drain : iovec[drain_count].iov_len;

        <span class="keywordflow">if</span> ((buffer = <a class="code" href="buffer_8h.html#aea3900024acc8e312908700d8a1a10d7" title="Create a new buffer from an existing chunk of memory.">flm_BufferNew</a> (iovec[drain_count].iov_base, \
                                     iov_read,                    \
                                     <a class="code" href="alloc_8c.html#a1f23294fcb8f31fc82577872ac7bab12">flm__Free</a>)) == NULL) {
            <span class="keywordflow">if</span> (((<a class="code" href="io_8h.html#acd3fd8ef9f4a34e935082468bbf981da">flm_IO</a> *)(stream))-&gt;er.handler) {
                ((<a class="code" href="io_8h.html#acd3fd8ef9f4a34e935082468bbf981da">flm_IO</a> *)(stream))-&gt;er.handler ((<a class="code" href="io_8h.html#acd3fd8ef9f4a34e935082468bbf981da">flm_IO</a> *) stream,
                                                  ((<a class="code" href="io_8h.html#acd3fd8ef9f4a34e935082468bbf981da">flm_IO</a> *)(stream))-&gt;state,
                                                  <a class="code" href="error_8h.html#ad1766173eeafcea6be9be3c16c30fb95" title="Return last error code.">flm_Error</a>());
            }
            <span class="keywordflow">goto</span> out;
        }

        <span class="keywordflow">if</span> (stream-&gt;rd.handler) {
            stream-&gt;rd.handler (stream,
                                ((<a class="code" href="io_8h.html#acd3fd8ef9f4a34e935082468bbf981da">flm_IO</a> *)(stream))-&gt;state,
                                buffer);
        }

        <span class="keywordflow">if</span> (drain &lt; iovec[drain_count].iov_len) {
            ((<a class="code" href="io_8h.html#acd3fd8ef9f4a34e935082468bbf981da">flm_IO</a> *)(stream))-&gt;rd.can = 0;
            drain = 0;
        }
        <span class="keywordflow">else</span> {
            drain -= iovec[drain_count].iov_len;
        }
    }

  out:
    <span class="comment">/* free remaining iov_bases */</span>
    <span class="keywordflow">for</span> (iov_count = drain_count; iov_count &lt; count; iov_count++) {
        <a class="code" href="alloc_8c.html#a1f23294fcb8f31fc82577872ac7bab12">flm__Free</a> (iovec[iov_count].iov_base);
    }

    return ;
}
</pre></div>
</div>
</div>
<a class="anchor" id="af98cfd968a8e3576aaa8b55ec3497acf"></a><!-- doxytag: member="stream.c::flm__StreamPerfWrite" ref="af98cfd968a8e3576aaa8b55ec3497acf" args="(flm_Stream *stream, flm_Monitor *monitor, uint8_t count)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void flm__StreamPerfWrite </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stream_8h.html#a65e0530bc901a350586f5e057d6195d8">flm_Stream</a> *&#160;</td>
          <td class="paramname"><em>stream</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="monitor_8h.html#a4dbc134cf7b201482c4cd40297937c83">flm_Monitor</a> *&#160;</td>
          <td class="paramname"><em>monitor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>count</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><p>Call the error handler</p>
<p>Call the write handler with the number of bytes written</p>
</p>

<p>Definition at line <a class="el" href="stream_8c_source.html#l00506">506</a> of file <a class="el" href="stream_8c_source.html">stream.c</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keyword">struct </span>flm__StreamInput * input;
    <span class="keyword">struct </span>flm__StreamInput temp;
    ssize_t nb_write;
    ssize_t drain;

    (void) monitor;
    (void) count;

    nb_write = <a class="code" href="stream_8c.html#abcc390327ac215570404c507b30bdc1a">flm__StreamWrite</a> (stream);

    <span class="keywordflow">if</span> (nb_write &lt; 0) {
        <span class="keywordflow">if</span> (errno == EAGAIN || errno == EWOULDBLOCK) {
            <span class="comment">/* kernel buffer was full */</span>
            ((<a class="code" href="io_8h.html#acd3fd8ef9f4a34e935082468bbf981da">flm_IO</a> *)(stream))-&gt;wr.can = 0;
            <span class="keywordflow">return</span> ;
        }
        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (errno == EINTR) {
            <span class="comment">/* interrupted by a signal, just retry */</span>
            ((<a class="code" href="io_8h.html#acd3fd8ef9f4a34e935082468bbf981da">flm_IO</a> *)(stream))-&gt;wr.can = 1;
            <span class="keywordflow">return</span> ;
        }
        <span class="keywordflow">else</span> {
            <span class="comment">/* fatal error */</span>
            flm__Error = <a class="code" href="error_8h.html#a9d9ce0322d33a2cf7912aec85755e04ea5fd1acb896d913dddb2ebce92d95153d">FLM_ERR_ERRNO</a>;
            <a class="code" href="io_8h.html#a1dca3f3c2913ea4525bd071c07cf6496" title="Close the flm_io object immediatly.">flm_IOClose</a> ((<a class="code" href="io_8h.html#acd3fd8ef9f4a34e935082468bbf981da">flm_IO</a> *) stream);

            <span class="keywordflow">if</span> (((<a class="code" href="io_8h.html#acd3fd8ef9f4a34e935082468bbf981da">flm_IO</a> *)(stream))-&gt;er.handler) {
                ((<a class="code" href="io_8h.html#acd3fd8ef9f4a34e935082468bbf981da">flm_IO</a> *)(stream))-&gt;er.handler ((<a class="code" href="io_8h.html#acd3fd8ef9f4a34e935082468bbf981da">flm_IO</a> *) stream,
                                                  ((<a class="code" href="io_8h.html#acd3fd8ef9f4a34e935082468bbf981da">flm_IO</a> *)(stream))-&gt;state,
                                                  <a class="code" href="error_8h.html#ad1766173eeafcea6be9be3c16c30fb95" title="Return last error code.">flm_Error</a>());
            }
            return ;
        }
    }
                
    <span class="keywordflow">if</span> (stream-&gt;wr.handler) {
        stream-&gt;wr.handler (stream,
                            ((<a class="code" href="io_8h.html#acd3fd8ef9f4a34e935082468bbf981da">flm_IO</a> *)(stream))-&gt;state,
                            nb_write);
    }

    drain = nb_write;
    ((<a class="code" href="io_8h.html#acd3fd8ef9f4a34e935082468bbf981da">flm_IO</a> *)(stream))-&gt;wr.can = 1;
    TAILQ_FOREACH (input, &amp;(stream-&gt;inputs), entries) {
        <span class="keywordflow">if</span> (drain == 0) {
            break ;
        }
        <span class="keywordflow">if</span> (drain &lt; input-&gt;tried) {
            input-&gt;off += drain;
            input-&gt;count -= drain;
            ((<a class="code" href="io_8h.html#acd3fd8ef9f4a34e935082468bbf981da">flm_IO</a> *)(stream))-&gt;wr.can = 0;
            <span class="keywordflow">break</span> ;
        }

        drain -= input-&gt;tried;

        temp.entries = input-&gt;entries;
        <a class="code" href="obj_8c.html#a945a39c1ea76e1055163ba72e3a2a4d1">flm__Release</a> (input-&gt;class.obj);
        TAILQ_REMOVE (&amp;(stream-&gt;inputs), input, entries);
        <a class="code" href="alloc_8c.html#a1f23294fcb8f31fc82577872ac7bab12">flm__Free</a> (input);
        input = &amp;temp;
    }

    <span class="keywordflow">if</span> (TAILQ_FIRST (&amp;stream-&gt;inputs) == NULL) {
        ((<a class="code" href="io_8h.html#acd3fd8ef9f4a34e935082468bbf981da">flm_IO</a> *)(stream))-&gt;wr.want = <span class="keyword">false</span>;
    }
    return ;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a19b905a588314f7d097f1a4c29defd38"></a><!-- doxytag: member="stream.c::flm__StreamShutdownTLS" ref="a19b905a588314f7d097f1a4c29defd38" args="(flm_Stream *stream)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void flm__StreamShutdownTLS </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stream_8h.html#a65e0530bc901a350586f5e057d6195d8">flm_Stream</a> *&#160;</td>
          <td class="paramname"><em>stream</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="stream_8c_source.html#l00361">361</a> of file <a class="el" href="stream_8c_source.html">stream.c</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">if</span> (stream-&gt;tls.obj) {
        SSL_free (stream-&gt;tls.obj);
        stream-&gt;tls.obj = NULL;
    }
    return ;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ada1019fb43bc6d7523a5aec6e5957421"></a><!-- doxytag: member="stream.c::flm__StreamSysSendFile" ref="ada1019fb43bc6d7523a5aec6e5957421" args="(flm_Stream *stream)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ssize_t flm__StreamSysSendFile </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stream_8h.html#a65e0530bc901a350586f5e057d6195d8">flm_Stream</a> *&#160;</td>
          <td class="paramname"><em>stream</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="stream_8c_source.html#l00637">637</a> of file <a class="el" href="stream_8c_source.html">stream.c</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keyword">struct </span>flm__StreamInput * input;

    off_t off;

    <span class="keywordflow">if</span> ((input = TAILQ_FIRST (&amp;stream-&gt;inputs)) == NULL) {
        <span class="keywordflow">return</span> (0);
    }

    off = input-&gt;off;
    input-&gt;tried = input-&gt;count;
    <span class="keywordflow">return</span> (sendfile (((<a class="code" href="io_8h.html#acd3fd8ef9f4a34e935082468bbf981da">flm_IO</a> *)(stream))-&gt;sys.fd,              \
                      ((<a class="code" href="io_8h.html#acd3fd8ef9f4a34e935082468bbf981da">flm_IO</a> *)(input-&gt;class.file))-&gt;sys.fd,   \
                      &amp;off,                                      \
                      input-&gt;tried));
}
</pre></div>
</div>
</div>
<a class="anchor" id="a45d2060862f33c3fbddb67c219528e46"></a><!-- doxytag: member="stream.c::flm__StreamSysWritev" ref="a45d2060862f33c3fbddb67c219528e46" args="(flm_Stream *stream)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ssize_t flm__StreamSysWritev </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stream_8h.html#a65e0530bc901a350586f5e057d6195d8">flm_Stream</a> *&#160;</td>
          <td class="paramname"><em>stream</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="stream_8c_source.html#l00613">613</a> of file <a class="el" href="stream_8c_source.html">stream.c</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keyword">struct </span>flm__StreamInput * input;

    <span class="keyword">struct </span>iovec iovec[FLM_STREAM__IOVEC_SIZE];
    <span class="keywordtype">size_t</span> iov_count;

    iov_count = 0;
    TAILQ_FOREACH (input, &amp;stream-&gt;inputs, entries) {
        <span class="keywordflow">if</span> (iov_count == FLM_STREAM__IOVEC_SIZE) {
            break ;
        }
        <span class="keywordflow">if</span> (input-&gt;type != FLM__STREAM_TYPE_BUFFER) {
            break ;
        }

        iovec[iov_count].iov_base = &amp;input-&gt;class.buffer-&gt;content[input-&gt;off];
        iovec[iov_count].iov_len = input-&gt;tried = input-&gt;count;
        iov_count++;
    }
    <span class="keywordflow">return</span> (writev (((<a class="code" href="io_8h.html#acd3fd8ef9f4a34e935082468bbf981da">flm_IO</a> *)(stream))-&gt;sys.fd, iovec, iov_count));
}
</pre></div>
</div>
</div>
<a class="anchor" id="abcc390327ac215570404c507b30bdc1a"></a><!-- doxytag: member="stream.c::flm__StreamWrite" ref="abcc390327ac215570404c507b30bdc1a" args="(flm_Stream *stream)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ssize_t flm__StreamWrite </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stream_8h.html#a65e0530bc901a350586f5e057d6195d8">flm_Stream</a> *&#160;</td>
          <td class="paramname"><em>stream</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="stream_8c_source.html#l00586">586</a> of file <a class="el" href="stream_8c_source.html">stream.c</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keyword">struct </span>flm__StreamInput * input;
    ssize_t nb_write;

    <span class="keywordflow">if</span> ((input = TAILQ_FIRST (&amp;stream-&gt;inputs)) == NULL) {
        <span class="keywordflow">return</span> (0);
    }

    nb_write = 0;
    <span class="keywordflow">switch</span> (input-&gt;type) {
    <span class="keywordflow">case</span> FLM__STREAM_TYPE_BUFFER:
        nb_write = <a class="code" href="stream_8c.html#a45d2060862f33c3fbddb67c219528e46">flm__StreamSysWritev</a> (stream);
        break ;

    <span class="keywordflow">case</span> FLM__STREAM_TYPE_FILE:
<span class="preprocessor">#if defined (linux)</span>
<span class="preprocessor"></span>        nb_write = <a class="code" href="stream_8c.html#ada1019fb43bc6d7523a5aec6e5957421">flm__StreamSysSendFile</a> (stream);
<span class="preprocessor">#else</span>
<span class="preprocessor"></span>        nb_write = flm__StreamSysReadWriteTo (stream);
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>        break ;
    }
    <span class="keywordflow">return</span> (nb_write);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a1a5e35800f405a10bc937b0d96bcd25a"></a><!-- doxytag: member="stream.c::flm_StreamClose" ref="a1a5e35800f405a10bc937b0d96bcd25a" args="(flm_Stream *stream)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void flm_StreamClose </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stream_8h.html#a65e0530bc901a350586f5e057d6195d8">flm_Stream</a> *&#160;</td>
          <td class="paramname"><em>stream</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="stream_8c_source.html#l00222">222</a> of file <a class="el" href="stream_8c_source.html">stream.c</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="io_8h.html#a1dca3f3c2913ea4525bd071c07cf6496" title="Close the flm_io object immediatly.">flm_IOClose</a> ((<a class="code" href="io_8h.html#acd3fd8ef9f4a34e935082468bbf981da">flm_IO</a> *) stream);
}
</pre></div>
</div>
</div>
<a class="anchor" id="ac89ebf8bef6afa634e7097060d4988d9"></a><!-- doxytag: member="stream.c::flm_StreamNew" ref="ac89ebf8bef6afa634e7097060d4988d9" args="(flm_Monitor *monitor, int fd, void *state)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="stream_8h.html#a65e0530bc901a350586f5e057d6195d8">flm_Stream</a>* flm_StreamNew </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="monitor_8h.html#a4dbc134cf7b201482c4cd40297937c83">flm_Monitor</a> *&#160;</td>
          <td class="paramname"><em>monitor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>state</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="stream_8c_source.html#l00057">57</a> of file <a class="el" href="stream_8c_source.html">stream.c</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="stream_8h.html#a65e0530bc901a350586f5e057d6195d8">flm_Stream</a> * stream;

    <span class="keywordflow">if</span> ((stream = <a class="code" href="alloc_8c.html#aa9979f334876af9bcbe4c57c68a94cbb">flm__Alloc</a> (<span class="keyword">sizeof</span> (<a class="code" href="stream_8h.html#a65e0530bc901a350586f5e057d6195d8">flm_Stream</a>))) == NULL) {
        <span class="keywordflow">return</span> (NULL);
    }
    <span class="keywordflow">if</span> (<a class="code" href="stream_8c.html#a9af7e295293b36ff362a0faba9e7938f">flm__StreamInit</a> (stream, monitor, fd, state) == -1) {
        <a class="code" href="alloc_8c.html#a1f23294fcb8f31fc82577872ac7bab12">flm__Free</a> (stream);
        <span class="keywordflow">return</span> (NULL);
    }
    <span class="keywordflow">return</span> (stream);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a721b84a665aa58dcfb99e4ba50d354d9"></a><!-- doxytag: member="stream.c::flm_StreamOnClose" ref="a721b84a665aa58dcfb99e4ba50d354d9" args="(flm_Stream *stream, flm_StreamCloseHandler handler)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void flm_StreamOnClose </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stream_8h.html#a65e0530bc901a350586f5e057d6195d8">flm_Stream</a> *&#160;</td>
          <td class="paramname"><em>stream</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stream_8h.html#a0519764167d1d77205bb965935a1913a">flm_StreamCloseHandler</a>&#160;</td>
          <td class="paramname"><em>handler</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="stream_8c_source.html#l00244">244</a> of file <a class="el" href="stream_8c_source.html">stream.c</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="io_8h.html#a08cb48910113c99ef9e83d8cfd1df6da">flm_IOOnClose</a> ((<a class="code" href="io_8h.html#acd3fd8ef9f4a34e935082468bbf981da">flm_IO</a> *) stream, (<a class="code" href="io_8h.html#ae822bc0b65780855416e9666fa7ffaee">flm_IOCloseHandler</a>) handler);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a378ebbec28871878b0e521f3a6c0e715"></a><!-- doxytag: member="stream.c::flm_StreamOnError" ref="a378ebbec28871878b0e521f3a6c0e715" args="(flm_Stream *stream, flm_StreamErrorHandler handler)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void flm_StreamOnError </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stream_8h.html#a65e0530bc901a350586f5e057d6195d8">flm_Stream</a> *&#160;</td>
          <td class="paramname"><em>stream</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stream_8h.html#a1ab38a34ece4f7b1dff7527bab15751b">flm_StreamErrorHandler</a>&#160;</td>
          <td class="paramname"><em>handler</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="stream_8c_source.html#l00251">251</a> of file <a class="el" href="stream_8c_source.html">stream.c</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="io_8h.html#a68f92fabf69377dcf4d412a915d3c2b2">flm_IOOnError</a> ((<a class="code" href="io_8h.html#acd3fd8ef9f4a34e935082468bbf981da">flm_IO</a> *) stream, (<a class="code" href="io_8h.html#a6e03222d365f1383fe19a4134398f262">flm_IOErrorHandler</a>) handler);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a87cf04647e6d86a1037876f2093f949d"></a><!-- doxytag: member="stream.c::flm_StreamOnRead" ref="a87cf04647e6d86a1037876f2093f949d" args="(flm_Stream *stream, flm_StreamReadHandler handler)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void flm_StreamOnRead </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stream_8h.html#a65e0530bc901a350586f5e057d6195d8">flm_Stream</a> *&#160;</td>
          <td class="paramname"><em>stream</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stream_8h.html#a0ec80f75578491f6de5a5bbb7e3e659b">flm_StreamReadHandler</a>&#160;</td>
          <td class="paramname"><em>handler</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="stream_8c_source.html#l00228">228</a> of file <a class="el" href="stream_8c_source.html">stream.c</a>.</p>
<div class="fragment"><pre class="fragment">{
    stream-&gt;rd.handler = handler;
    return ;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a6b92f4a44789145b5922c13c14f30af3"></a><!-- doxytag: member="stream.c::flm_StreamOnWrite" ref="a6b92f4a44789145b5922c13c14f30af3" args="(flm_Stream *stream, flm_StreamWriteHandler handler)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void flm_StreamOnWrite </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stream_8h.html#a65e0530bc901a350586f5e057d6195d8">flm_Stream</a> *&#160;</td>
          <td class="paramname"><em>stream</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stream_8h.html#aaf1b1cc6600a251e810f1d01a0743030">flm_StreamWriteHandler</a>&#160;</td>
          <td class="paramname"><em>handler</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="stream_8c_source.html#l00236">236</a> of file <a class="el" href="stream_8c_source.html">stream.c</a>.</p>
<div class="fragment"><pre class="fragment">{
    stream-&gt;wr.handler = handler;
    return ;
}
</pre></div>
</div>
</div>
<a class="anchor" id="af82bbe9b6534bd640bad977106fba5d0"></a><!-- doxytag: member="stream.c::flm_StreamPrintf" ref="af82bbe9b6534bd640bad977106fba5d0" args="(flm_Stream *stream, const char *format,...)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int flm_StreamPrintf </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stream_8h.html#a65e0530bc901a350586f5e057d6195d8">flm_Stream</a> *&#160;</td>
          <td class="paramname"><em>stream</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>format</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>...</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="stream_8c_source.html#l00074">74</a> of file <a class="el" href="stream_8c_source.html">stream.c</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="buffer_8h.html#ae3f88afa1850fc7dee9e958bd023d220">flm_Buffer</a> * buffer;

    <span class="keywordtype">char</span> * content;
    <span class="keywordtype">int</span> len;
    <span class="keywordtype">size_t</span> alloc;

    va_list ap;

    va_start (ap, format);
    len = vsnprintf (NULL, 0, format, ap);
    va_end (ap);

    <span class="keywordflow">if</span> (len &lt; 0) {
        <span class="keywordflow">goto</span> error;
    }

    alloc = len + 1;

    content = <a class="code" href="alloc_8c.html#aa9979f334876af9bcbe4c57c68a94cbb">flm__Alloc</a> (alloc * <span class="keyword">sizeof</span> (<span class="keywordtype">char</span>));
    <span class="keywordflow">if</span> (content == NULL) {
        <span class="keywordflow">goto</span> error;
    }

    va_start (ap, format);
    len = vsnprintf (content, alloc, format, ap);
    va_end (ap);

    <span class="keywordflow">if</span> (len &lt; 0) {
        <span class="keywordflow">goto</span> free_content;
    }

    <span class="keywordflow">if</span> ((buffer = <a class="code" href="buffer_8h.html#aea3900024acc8e312908700d8a1a10d7" title="Create a new buffer from an existing chunk of memory.">flm_BufferNew</a> (content, len, <a class="code" href="alloc_8c.html#a1f23294fcb8f31fc82577872ac7bab12">flm__Free</a>)) == NULL) {
        <span class="keywordflow">goto</span> free_content;
    }

    <span class="keywordflow">if</span> (<a class="code" href="stream_8h.html#adad497fd1d6cad72b6da00b297a45c00">flm_StreamPushBuffer</a> (stream, buffer, 0, 0) == -1) {
        <span class="keywordflow">goto</span> release_buffer;
    }
    <a class="code" href="buffer_8h.html#a39271099b1606b4154553f9442011db7">flm_BufferRelease</a> (buffer);

    <span class="keywordflow">return</span> (0);

  release_buffer:
    <a class="code" href="buffer_8h.html#a39271099b1606b4154553f9442011db7">flm_BufferRelease</a> (buffer);
    <span class="keywordflow">return</span> (-1);
  free_content:
    <a class="code" href="alloc_8c.html#a1f23294fcb8f31fc82577872ac7bab12">flm__Free</a> (content);
  error:
    <span class="keywordflow">return</span> (-1);
}
</pre></div>
</div>
</div>
<a class="anchor" id="adad497fd1d6cad72b6da00b297a45c00"></a><!-- doxytag: member="stream.c::flm_StreamPushBuffer" ref="adad497fd1d6cad72b6da00b297a45c00" args="(flm_Stream *stream, flm_Buffer *buffer, off_t off, size_t count)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int flm_StreamPushBuffer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stream_8h.html#a65e0530bc901a350586f5e057d6195d8">flm_Stream</a> *&#160;</td>
          <td class="paramname"><em>stream</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="buffer_8h.html#ae3f88afa1850fc7dee9e958bd023d220">flm_Buffer</a> *&#160;</td>
          <td class="paramname"><em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">off_t&#160;</td>
          <td class="paramname"><em>off</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>count</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="stream_8c_source.html#l00130">130</a> of file <a class="el" href="stream_8c_source.html">stream.c</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keyword">struct </span>flm__StreamInput * input;

    <span class="keywordflow">if</span> (off &lt; 0) {
        off = 0;
    }
    <span class="keywordflow">if</span> (off &gt; (off_t) buffer-&gt;len) {
        off = buffer-&gt;len;
    }
    <span class="keywordflow">if</span> (count == 0 || count &gt; buffer-&gt;len) {
        count = buffer-&gt;len - off;
    }

    <span class="keywordflow">if</span> ((input = <a class="code" href="alloc_8c.html#aa9979f334876af9bcbe4c57c68a94cbb">flm__Alloc</a> (<span class="keyword">sizeof</span> (<span class="keyword">struct</span> flm__StreamInput))) == NULL) {
        <span class="keywordflow">goto</span> error;
    }

    ((<a class="code" href="io_8h.html#acd3fd8ef9f4a34e935082468bbf981da">flm_IO</a> *)(stream))-&gt;wr.want = <span class="keyword">true</span>;
    if (((<a class="code" href="io_8h.html#acd3fd8ef9f4a34e935082468bbf981da">flm_IO</a> *)(stream))-&gt;monitor &amp;&amp;                            \
        <a class="code" href="monitor_8c.html#a1ccbcea143786e693824be7af45c9978">flm__MonitorIOReset</a> (((<a class="code" href="io_8h.html#acd3fd8ef9f4a34e935082468bbf981da">flm_IO</a> *)(stream))-&gt;monitor,
                             (<a class="code" href="io_8h.html#acd3fd8ef9f4a34e935082468bbf981da">flm_IO</a> *) stream) == -1) {
        <span class="keywordflow">goto</span> free_input;
    }

    input-&gt;class.buffer = <a class="code" href="buffer_8h.html#a517486e28c19139b4765f097ea0e6b85">flm_BufferRetain</a> (buffer);
    input-&gt;type = FLM__STREAM_TYPE_BUFFER;
    input-&gt;off = off;
    input-&gt;count = count;
    TAILQ_INSERT_TAIL (&amp;(stream-&gt;inputs), input, entries);

    <span class="keywordflow">return</span> (0);

  free_input:
    <a class="code" href="alloc_8c.html#a1f23294fcb8f31fc82577872ac7bab12">flm__Free</a> (input);
  error:
    <span class="keywordflow">return</span> (-1);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a0c2f4e67b4018f9772cc02904a562803"></a><!-- doxytag: member="stream.c::flm_StreamPushFile" ref="a0c2f4e67b4018f9772cc02904a562803" args="(flm_Stream *stream, flm_File *file, off_t off, size_t count)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int flm_StreamPushFile </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stream_8h.html#a65e0530bc901a350586f5e057d6195d8">flm_Stream</a> *&#160;</td>
          <td class="paramname"><em>stream</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="file_8h.html#a6d8926d421432d97489a92bda2cd53bf">flm_File</a> *&#160;</td>
          <td class="paramname"><em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">off_t&#160;</td>
          <td class="paramname"><em>off</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>count</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="stream_8c_source.html#l00173">173</a> of file <a class="el" href="stream_8c_source.html">stream.c</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keyword">struct </span>flm__StreamInput * input;
    <span class="keyword">struct </span>stat stat;

    <span class="keywordflow">if</span> (count == 0) {
        <span class="keywordflow">if</span> (fstat (((<a class="code" href="io_8h.html#acd3fd8ef9f4a34e935082468bbf981da">flm_IO</a> *)(file))-&gt;sys.fd, &amp;stat) == -1) {
            <span class="keywordflow">return</span> (-1);
        }
        <span class="keywordflow">if</span> (off &gt; stat.st_size) {
            off = stat.st_size;
        }
        count = stat.st_size - off;
    }
    
    <span class="keywordflow">if</span> ((input = <a class="code" href="alloc_8c.html#aa9979f334876af9bcbe4c57c68a94cbb">flm__Alloc</a> (<span class="keyword">sizeof</span> (<span class="keyword">struct</span> flm__StreamInput))) == NULL) {
        <span class="keywordflow">goto</span> error;
    }
    <span class="keywordflow">if</span> (((<a class="code" href="io_8h.html#acd3fd8ef9f4a34e935082468bbf981da">flm_IO</a> *)(stream))-&gt;monitor &amp;&amp;                           \
        <a class="code" href="monitor_8c.html#a1ccbcea143786e693824be7af45c9978">flm__MonitorIOReset</a> (((<a class="code" href="io_8h.html#acd3fd8ef9f4a34e935082468bbf981da">flm_IO</a> *)(stream))-&gt;monitor,        \
                             (<a class="code" href="io_8h.html#acd3fd8ef9f4a34e935082468bbf981da">flm_IO</a> *) stream) == -1) {
        <span class="keywordflow">goto</span> free_input;
    }   
    
    input-&gt;class.file = <a class="code" href="file_8h.html#ae606fdffd02a553cf89f52a5ae1fe282">flm_FileRetain</a> (file);
    input-&gt;type = FLM__STREAM_TYPE_BUFFER;
    input-&gt;off = off;
    input-&gt;count = count;
    TAILQ_INSERT_TAIL (&amp;(stream-&gt;inputs), input, entries);
    
    ((<a class="code" href="io_8h.html#acd3fd8ef9f4a34e935082468bbf981da">flm_IO</a> *)(stream))-&gt;wr.want = <span class="keyword">true</span>;
    return (0);
    
  free_input:
    <a class="code" href="alloc_8c.html#a1f23294fcb8f31fc82577872ac7bab12">flm__Free</a> (input);
  error:
    <span class="keywordflow">return</span> (-1);
}
</pre></div>
</div>
</div>
<a class="anchor" id="ada4474f10a2c8e7d97b27c983d56ef6c"></a><!-- doxytag: member="stream.c::flm_StreamRelease" ref="ada4474f10a2c8e7d97b27c983d56ef6c" args="(flm_Stream *stream)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void flm_StreamRelease </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stream_8h.html#a65e0530bc901a350586f5e057d6195d8">flm_Stream</a> *&#160;</td>
          <td class="paramname"><em>stream</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="stream_8c_source.html#l00304">304</a> of file <a class="el" href="stream_8c_source.html">stream.c</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="obj_8c.html#a945a39c1ea76e1055163ba72e3a2a4d1">flm__Release</a> ((<a class="code" href="obj_8h.html#a06d6af323c74441b131bdec66c72f531">flm_Obj</a> *) stream);
    return ;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ab6fabd6657be4765086bb825e9bcd525"></a><!-- doxytag: member="stream.c::flm_StreamRetain" ref="ab6fabd6657be4765086bb825e9bcd525" args="(flm_Stream *stream)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="stream_8h.html#a65e0530bc901a350586f5e057d6195d8">flm_Stream</a>* flm_StreamRetain </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stream_8h.html#a65e0530bc901a350586f5e057d6195d8">flm_Stream</a> *&#160;</td>
          <td class="paramname"><em>stream</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="stream_8c_source.html#l00298">298</a> of file <a class="el" href="stream_8c_source.html">stream.c</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">return</span> (<a class="code" href="obj_8c.html#aba363d16627409b2f2aad4270292dec2">flm__Retain</a> ((<a class="code" href="obj_8h.html#a06d6af323c74441b131bdec66c72f531">flm_Obj</a> *) stream));
}
</pre></div>
</div>
</div>
<a class="anchor" id="a14ab6f72503af42413a2a65fb8128344"></a><!-- doxytag: member="stream.c::flm_StreamShutdown" ref="a14ab6f72503af42413a2a65fb8128344" args="(flm_Stream *stream)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void flm_StreamShutdown </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stream_8h.html#a65e0530bc901a350586f5e057d6195d8">flm_Stream</a> *&#160;</td>
          <td class="paramname"><em>stream</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="stream_8c_source.html#l00216">216</a> of file <a class="el" href="stream_8c_source.html">stream.c</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="io_8h.html#a5ee72d10acb72a90ffd6f1ae76890179" title="Close the flm_io object as soon as possible.">flm_IOShutdown</a> ((<a class="code" href="io_8h.html#acd3fd8ef9f4a34e935082468bbf981da">flm_IO</a> *) stream);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a4623c56ab66662b0dfd9ca8bc7d81e57"></a><!-- doxytag: member="stream.c::flm_StreamStartTLSClient" ref="a4623c56ab66662b0dfd9ca8bc7d81e57" args="(flm_Stream *stream, SSL_CTX *context)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int flm_StreamStartTLSClient </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stream_8h.html#a65e0530bc901a350586f5e057d6195d8">flm_Stream</a> *&#160;</td>
          <td class="paramname"><em>stream</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SSL_CTX *&#160;</td>
          <td class="paramname"><em>context</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="stream_8c_source.html#l00278">278</a> of file <a class="el" href="stream_8c_source.html">stream.c</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">if</span> (<a class="code" href="stream_8c.html#ae17c28596897dc6eba0b22881196cebb">flm__StreamInitTLS</a> (stream, context) == -1) {
        <span class="keywordflow">goto</span> error;
    }

    <span class="keywordflow">if</span> (SSL_connect (stream-&gt;tls.obj) &lt; 0) {
        <span class="keywordflow">goto</span> shutdown_tls;
    }

    <span class="keywordflow">return</span> (0);
    
  shutdown_tls:
    <a class="code" href="stream_8c.html#a19b905a588314f7d097f1a4c29defd38">flm__StreamShutdownTLS</a> (stream);
  error:
    <span class="keywordflow">return</span> (-1);
}
</pre></div>
</div>
</div>
<a class="anchor" id="adad86858ba5e1266089929dc369635f1"></a><!-- doxytag: member="stream.c::flm_StreamStartTLSServer" ref="adad86858ba5e1266089929dc369635f1" args="(flm_Stream *stream, SSL_CTX *context)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int flm_StreamStartTLSServer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stream_8h.html#a65e0530bc901a350586f5e057d6195d8">flm_Stream</a> *&#160;</td>
          <td class="paramname"><em>stream</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SSL_CTX *&#160;</td>
          <td class="paramname"><em>context</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="stream_8c_source.html#l00258">258</a> of file <a class="el" href="stream_8c_source.html">stream.c</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">if</span> (<a class="code" href="stream_8c.html#ae17c28596897dc6eba0b22881196cebb">flm__StreamInitTLS</a> (stream, context) == -1) {
        <span class="keywordflow">goto</span> error;
    }

    <span class="keywordflow">if</span> (SSL_accept (stream-&gt;tls.obj) &lt; 0) {
        <span class="keywordflow">goto</span> shutdown_tls;
    }

    <span class="keywordflow">return</span> (0);
    
  shutdown_tls:
    <a class="code" href="stream_8c.html#a19b905a588314f7d097f1a4c29defd38">flm__StreamShutdownTLS</a> (stream);
  error:
    <span class="keywordflow">return</span> (-1);
}
</pre></div>
</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="a50d91b812f208363668840c0913b6179"></a><!-- doxytag: member="stream.c::flm__StreamErrors" ref="a50d91b812f208363668840c0913b6179" args="[]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* <a class="el" href="stream_8c.html#a50d91b812f208363668840c0913b6179">flm__StreamErrors</a>[]</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Initial value:</b><div class="fragment"><pre class="fragment">
{
    <span class="stringliteral">&quot;Object is not shared&quot;</span>,
    <span class="stringliteral">&quot;Not implemented&quot;</span>
}
</pre></div>
<p>Definition at line <a class="el" href="stream_8c_source.html#l00050">50</a> of file <a class="el" href="stream_8c_source.html">stream.c</a>.</p>

</div>
</div>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address class="footer"><small>Generated on Mon Mar 7 2011 for libflm by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.3 </small></address>
</body>
</html>
